# å¸‚å ´æ•¸æ“šå®Œæ•´æ¸¬è©¦ Demo ä½¿ç”¨æŒ‡å—

## ğŸ“‹ Demo åŠŸèƒ½

æ¸¬è©¦ä¸¦å±•ç¤º 4 ç¨®å¸‚å ´æ•¸æ“šå›èª¿ï¼š
1. **Depth** - è¨‚å–®ç°¿æ·±åº¦æ•¸æ“šï¼ˆ10æª”è²·è³£ç›¤ï¼‰
2. **Ticker** - 24å°æ™‚çµ±è¨ˆæ•¸æ“šï¼ˆæœ€ä½³è²·è³£åƒ¹ï¼‰
3. **Trade** - å…¬é–‹æˆäº¤æµï¼ˆå¯¦æ™‚æˆäº¤è¨˜éŒ„ï¼‰
4. **IndexPrice** - æŒ‡æ•¸åƒ¹æ ¼ï¼ˆFutures å°ˆç”¨ï¼‰

---

## ğŸš€ å¿«é€Ÿå•Ÿå‹•

```bash
# 1. ç¢ºä¿ Master + Ledger + MD å·²å•Ÿå‹•
pm2 list
# æ‡‰è©²çœ‹åˆ° master, ledger, md_binance éƒ½åœ¨é‹è¡Œ

# 2. å•Ÿå‹•æ¸¬è©¦ç­–ç•¥
pm2 start ecosystem.config.js --only market_data_demo

# 3. æŸ¥çœ‹æ—¥èªŒ
pm2 logs market_data_demo --lines 50

# 4. åœæ­¢
pm2 stop market_data_demo
pm2 delete market_data_demo
```



---

## ğŸ“Š é æœŸè¼¸å‡ºç¯„ä¾‹

### å•Ÿå‹•æ™‚

```
================================================================================
ğŸš€ å¸‚å ´æ•¸æ“šæ¸¬è©¦ Demo å•Ÿå‹•
   äº¤æ˜“å°: btc_usdt
   äº¤æ˜“æ‰€: BINANCE
   å¸‚å ´é¡å‹: USDT-Margined Futures
   æ•¸æ“šæº: binance_md
================================================================================
ğŸ“Š è¨‚é–± Depth (è¨‚å–®ç°¿æ·±åº¦)
ğŸ“ˆ è¨‚é–± Ticker (24å°æ™‚çµ±è¨ˆ)
ğŸ’° è¨‚é–± Trade (å…¬é–‹æˆäº¤æµ)
ğŸ”¢ è¨‚é–± IndexPrice (æŒ‡æ•¸åƒ¹æ ¼)

âœ… è¨‚é–±å®Œæˆï¼Œç­‰å¾…å¸‚å ´æ•¸æ“š...
```

### Depth æ•¸æ“šè¼¸å‡ºï¼ˆæ¯ 10 æ¬¡ï¼‰

```
ğŸ“Š [10] Depth Update - btc_usdt
   â”œâ”€ æœ€ä½³è²·åƒ¹: 96,500.00 USDT (é‡: 2.3450)
   â”œâ”€ æœ€ä½³è³£åƒ¹: 96,501.50 USDT (é‡: 1.8920)
   â”œâ”€ ä¸­é–“åƒ¹: 96,500.75 USDT
   â”œâ”€ åƒ¹å·®: 1.50 USDT (0.0016%)
   â”œâ”€ è²·ç›¤ç¸½é‡ (å‰5æª”): 12.5670
   â”œâ”€ è³£ç›¤ç¸½é‡ (å‰5æª”): 10.8940
   â””â”€ æ•¸æ“šæ™‚é–“: 14:23:45
```

### Ticker æ•¸æ“šè¼¸å‡º

```
ğŸ“ˆ [3] Ticker Update - btc_usdt
   â”œâ”€ è²·: 96,500.00 USDT (é‡: 2.3450)
   â”œâ”€ è³£: 96,501.50 USDT (é‡: 1.8920)
   â””â”€ æ™‚é–“: 14:23:46
```

### Trade æ•¸æ“šè¼¸å‡ºï¼ˆå¯¦æ™‚æˆäº¤ï¼‰

```
ğŸ’° [15] Trade - btc_usdt
   â”œâ”€ ID: 1234567890
   â”œâ”€ æ–¹å‘: ğŸŸ¢ è²·å…¥
   â”œâ”€ åƒ¹æ ¼: 96,501.50 USDT
   â”œâ”€ æ•¸é‡: 0.1250
   â”œâ”€ é‡‘é¡: 12,062.69 USDT
   â””â”€ æ™‚é–“: 14:23:47.123
```

### IndexPrice æ•¸æ“šè¼¸å‡º

```
ğŸ”¢ [5] IndexPrice - btc_usdt
   â”œâ”€ æŒ‡æ•¸åƒ¹æ ¼: 96,500.25 USDT
   â””â”€ èªªæ˜: å¤šå€‹ç¾è²¨äº¤æ˜“æ‰€çš„åŠ æ¬Šå¹³å‡åƒ¹æ ¼
```

### åœæ­¢æ™‚çµ±è¨ˆ

```
================================================================================
ğŸ“Š å¸‚å ´æ•¸æ“šæ¥æ”¶çµ±è¨ˆ
================================================================================
é‹è¡Œæ™‚é•·: 30.0 ç§’

Depth (è¨‚å–®ç°¿):     æ¥æ”¶    300 æ¬¡ | å¹³å‡é »ç‡:  10.00 æ¬¡/ç§’
Ticker (çµ±è¨ˆ):      æ¥æ”¶     15 æ¬¡ | å¹³å‡é »ç‡:   0.50 æ¬¡/ç§’
Trade (å…¬é–‹æˆäº¤):   æ¥æ”¶     45 æ¬¡ | å¹³å‡é »ç‡:   1.50 æ¬¡/ç§’
IndexPrice (æŒ‡æ•¸):  æ¥æ”¶     30 æ¬¡ | å¹³å‡é »ç‡:   1.00 æ¬¡/ç§’
================================================================================
âœ… ç­–ç•¥å·²åœæ­¢
================================================================================
```

---

## ğŸ” æ•¸æ“šçµæ§‹è©³è§£

### 1. Depth (è¨‚å–®ç°¿)

| å­—æ®µ | é¡å‹ | èªªæ˜ | ç¯„ä¾‹ |
|------|------|------|------|
| `symbol` | string | äº¤æ˜“å° | `"btc_usdt"` |
| `bid_price[0-9]` | double[10] | è²·ç›¤åƒ¹æ ¼ï¼ˆé™åºï¼‰ | `[96500.0, 96499.5, ...]` |
| `bid_volume[0-9]` | double[10] | è²·ç›¤æ•¸é‡ | `[2.345, 1.892, ...]` |
| `ask_price[0-9]` | double[10] | è³£ç›¤åƒ¹æ ¼ï¼ˆå‡åºï¼‰ | `[96501.5, 96502.0, ...]` |
| `ask_volume[0-9]` | double[10] | è³£ç›¤æ•¸é‡ | `[1.892, 2.115, ...]` |
| `data_time` | int64 | æ•¸æ“šæ™‚é–“ï¼ˆç´ç§’ï¼‰ | `1700000000000000000` |

**é‡è¦**ï¼š
- `bid_price[0]` æ˜¯**æœ€ä½³è²·åƒ¹**ï¼ˆæœ€é«˜è²·å…¥åƒ¹ï¼‰
- `ask_price[0]` æ˜¯**æœ€ä½³è³£åƒ¹**ï¼ˆæœ€ä½è³£å‡ºåƒ¹ï¼‰
- æ•¸çµ„æŒ‰åƒ¹æ ¼å„ªå…ˆç´šæ’åº

### 2. Ticker (çµ±è¨ˆ)

| å­—æ®µ | é¡å‹ | èªªæ˜ | ç¯„ä¾‹ |
|------|------|------|------|
| `symbol` | string | äº¤æ˜“å° | `"btc_usdt"` |
| `bid_price` | double | æœ€ä½³è²·åƒ¹ | `96500.0` |
| `bid_volume` | double | æœ€ä½³è²·é‡ | `2.345` |
| `ask_price` | double | æœ€ä½³è³£åƒ¹ | `96501.5` |
| `ask_volume` | double | æœ€ä½³è³£é‡ | `1.892` |
| `data_time` | int64 | æ•¸æ“šæ™‚é–“ | `1700000000000000000` |

### 3. Trade (å…¬é–‹æˆäº¤)

| å­—æ®µ | é¡å‹ | èªªæ˜ | ç¯„ä¾‹ |
|------|------|------|------|
| `symbol` | string | äº¤æ˜“å° | `"btc_usdt"` |
| `trade_id` | int64 | æˆäº¤ ID | `1234567890` |
| `price` | double | æˆäº¤åƒ¹ | `96501.5` |
| `volume` | double | æˆäº¤é‡ | `0.125` |
| `side` | Side | ä¸»å‹•æ–¹å‘ | `Side.Buy` / `Side.Sell` |
| `trade_time` | int64 | æˆäº¤æ™‚é–“ï¼ˆç´ç§’ï¼‰ | `1700000000000000000` |

**ä¸»å‹•æ–¹å‘èªªæ˜**ï¼š
- `Side.Buy` (ğŸŸ¢) - ä¸»å‹•è²·å…¥ï¼ˆåƒæ‰è³£å–®ï¼Œåƒ¹æ ¼ä¸Šæ¨ï¼‰
- `Side.Sell` (ğŸ”´) - ä¸»å‹•è³£å‡ºï¼ˆåƒæ‰è²·å–®ï¼Œåƒ¹æ ¼ä¸‹å£“ï¼‰

### 4. IndexPrice (æŒ‡æ•¸åƒ¹æ ¼)

| å­—æ®µ | é¡å‹ | èªªæ˜ | ç¯„ä¾‹ |
|------|------|------|------|
| `symbol` | string | äº¤æ˜“å° | `"btc_usdt"` |
| `price` | double | æŒ‡æ•¸åƒ¹æ ¼ | `96500.25` |
| `exchange_id` | string | äº¤æ˜“æ‰€ | `"binance"` |
| `instrument_type` | InstrumentType | å·¥å…·é¡å‹ | `InstrumentType.FFuture` |

---

## âš™ï¸ é…ç½®èªªæ˜

ç·¨è¼¯ `strategies/market_data_demo_config.json`:

```json
{
  "name": "market_data_demo",       // ç­–ç•¥åç¨±
  "symbol": "btc_usdt",             // äº¤æ˜“å°ï¼ˆå¯æ”¹ç‚º eth_usdt ç­‰ï¼‰
  "md_source": "binance_md",        // MD Gateway åç¨±
  "account": "gz_user1"             // å¸³æˆ¶åç¨±ï¼ˆæœ¬ demo ä¸ä¸‹å–®ï¼Œå¯å¿½ç•¥ï¼‰
}
```

---

## ğŸ› å¸¸è¦‹å•é¡Œ

### 1. æ²’æœ‰æ”¶åˆ°æ•¸æ“š

**æª¢æŸ¥æ¸…å–®**ï¼š
- [ ] MD Gateway æ˜¯å¦å•Ÿå‹•ï¼Ÿ`pm2 list` æŸ¥çœ‹ `md_binance` ç‹€æ…‹
- [ ] MD Gateway æ—¥èªŒæ˜¯å¦æœ‰éŒ¯èª¤ï¼Ÿ`pm2 logs md_binance --lines 50`
- [ ] é…ç½®ä¸­çš„ `md_source` æ˜¯å¦æ­£ç¢ºï¼Ÿï¼ˆæ‡‰ç‚º `"binance_md"`ï¼‰
- [ ] Master/Ledger æ˜¯å¦é‹è¡Œï¼Ÿ

### 2. åªæ”¶åˆ° Depthï¼Œæ²’æœ‰ Ticker/Trade/IndexPrice

**åŸå› **ï¼š
- `subscribe_ticker()` / `subscribe_trade()` / `subscribe_index_price()` éœ€è¦å–®ç¨è¨‚é–±
- æª¢æŸ¥ `pre_start()` ä¸­æ˜¯å¦éƒ½å·²èª¿ç”¨

### 3. Trade æ•¸æ“šé »ç‡å¾ˆä½

**æ­£å¸¸**ï¼š
- Trade æ˜¯å¯¦æ™‚æˆäº¤æ•¸æ“šï¼Œé »ç‡å–æ±ºæ–¼å¸‚å ´æ´»èºåº¦
- BTC/USDT é€šå¸¸è¼ƒæ´»èºï¼ˆ1-10 æ¬¡/ç§’ï¼‰
- å†·é–€äº¤æ˜“å°å¯èƒ½å¹¾ç§’æ‰ä¸€ç­†

### 4. IndexPrice æ²’æœ‰æ•¸æ“š

**æª¢æŸ¥**ï¼š
- IndexPrice åƒ… **Futures** åˆç´„æœ‰æ•ˆ
- ç¢ºèª `instrument_type = InstrumentType.FFuture`
- Spot å¸‚å ´æ²’æœ‰ IndexPrice

---

## ğŸ“ å­¸ç¿’ä»»å‹™

å®Œæˆä»¥ä¸‹ä»»å‹™ä»¥æŒæ¡å¸‚å ´æ•¸æ“šï¼š

- [ ] æˆåŠŸå•Ÿå‹• demo ä¸¦çœ‹åˆ° 4 ç¨®æ•¸æ“šè¼¸å‡º
- [ ] ç†è§£ Depth æ•¸çµ„ç´¢å¼•ï¼ˆbid[0] æ˜¯æœ€ä½³è²·åƒ¹ï¼‰
- [ ] è§€å¯Ÿ Trade çš„æ–¹å‘ï¼ˆBuy vs Sellï¼‰èˆ‡åƒ¹æ ¼è®ŠåŒ–çš„é—œä¿‚
- [ ] è¨ˆç®—ä¸¦æ‰“å°è‡ªå®šç¾©æŒ‡æ¨™ï¼ˆå¦‚ï¼šè¨‚å–®ç°¿ä¸å¹³è¡¡åº¦ï¼‰
- [ ] ä¿®æ”¹ä»£ç¢¼ï¼Œåªåœ¨åƒ¹å·®å¤§æ–¼æŸé–¾å€¼æ™‚æ‰“å° Depth

---

## ğŸ“š ä¸‹ä¸€æ­¥

å®Œæˆæœ¬ demo å¾Œï¼Œå¯ä»¥ç¹¼çºŒï¼š

1. **éšæ®µ 4**: å¯¦ç¾ç°¡å–®äº¤æ˜“ç­–ç•¥ï¼ˆä¸‹å–®/æ’¤å–®ï¼‰
2. **ç­–ç•¥ç¯„ä¾‹**: åŸºæ–¼ Depth æ•¸æ“šå¯¦ç¾ç°¡å–®åšå¸‚ç­–ç•¥
3. **é«˜ç´šåˆ†æ**: è¨ˆç®—è¨‚å–®ç°¿æµå‹•æ€§ã€åƒ¹æ ¼è¡æ“Šç­‰æŒ‡æ¨™

---

**ä½œè€…**: AI Assistant
**æ—¥æœŸ**: 2025-11-19
**ç‰ˆæœ¬**: 1.0
